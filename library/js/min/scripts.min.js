var GameObject,GameObjects;GameObjects={},GameObject=function(){function t(){this.id=Utils.uuid(),GameObjects[this.id]=this}return t.prototype.update=function(){},t.prototype.destroy=function(){return delete GameObjects[this.id]},t}();var Menu;Menu={preload:function(){return game.load.image("background","library/assets/background.png")},create:function(){var t,i;game.add.sprite(0,0,"background"),i=game.add.text(game.world.centerX,150,"Blind Aliens",{font:"65px Arial",fill:"#ffffff",align:"center"}),i.anchor.setTo(.5,.5),t=game.add.text(game.world.centerX,300,"Click anywhere to play the game",{font:"16px Arial",fill:"#bbbbbb",align:"center"}),t.anchor.setTo(.5,.5)},update:function(){game.input.activePointer.justPressed()&&game.state.start("play")}};var Play;Play=function(){function t(){}return t.prototype.preload=function(){return game.load.image("background","library/assets/background.png"),game.load.image("player","library/assets/player.png"),game.load.image("circle","library/assets/circle.png"),game.load.audio("footstep","library/assets/footstep.wav"),game.load.audio("gunshot","library/assets/gunshot.wav")},t.prototype.create=function(){var t,i,e,s,r;for(game.physics.startSystem(Phaser.Physics.ARCADE),game.add.sprite(0,0,"background"),e=new Player(50,50),r=[],i=s=1;3>=s;i=++s)r.push(t=new Alien(150*i,500));return r},t.prototype.update=function(){var t,i,e;e=[];for(t in GameObjects)i=GameObjects[t],e.push(i.update());return e},t}();var Utils;Utils={},Utils.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i,e;return i=16*Math.random()|0,e="x"===t?i:3&i|8,e.toString(16)})};var Circle,__hasProp={}.hasOwnProperty,__extends=function(t,i){function e(){this.constructor=t}for(var s in i)__hasProp.call(i,s)&&(t[s]=i[s]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t};Circle=function(t){function i(t,e,s){this.x=t,this.y=e,this.r=s,i.__super__.constructor.call(this),this.sprite=game.add.sprite(this.x,this.y,"circle"),this.sprite.anchor.x=.5,this.sprite.anchor.y=.5,this.sprite.width=10,this.sprite.height=10,this.rad=this.r,this.sfx=game.add.audio("footstep"),this.sfx.play()}return __extends(i,t),i.prototype.update=function(){var t;return t=3+this.sprite.width,this.sprite.width=t,this.sprite.height=t,this.sprite.alpha=1-t/this.rad,this.invalid()?this.destroy():void 0},i.prototype.invalid=function(){return this.sprite.height>2*this.rad},i.prototype.destroy=function(){return this.sprite.destroy(),this.sfx.destroy(),i.__super__.destroy.call(this)},i}(GameObject);var Alien,__hasProp={}.hasOwnProperty,__extends=function(t,i){function e(){this.constructor=t}for(var s in i)__hasProp.call(i,s)&&(t[s]=i[s]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t};Alien=function(t){function i(t,e){i.__super__.constructor.call(this),this.isAlien=!0,this.MAX_SPEED=600,this.state=this.constructor.STATES.UNAWARE,this.sprite=game.add.sprite(t,e,"circle"),this.sprite.scale.setTo(.3,.3),game.physics.arcade.enable(this.sprite),this.sprite.body.collideWorldBounds=!0,this.sprite.anchor.setTo(.5,.75),this.state=this.constructor.STATES.UNAWARE}return __extends(i,t),i.STATES={UNAWARE:"WAITING",AWARE:{x:0,y:0}},i.prototype.update=function(){return this.sprite.bringToTop(),this.state===this.constructor.STATES.UNAWARE?this._randomWalk():this._awareWalk()},i.prototype._randomWalk=function(){var t;return t=2*Math.random()*Math.PI,this.sprite.body.acceleration.x=.5*this.MAX_SPEED*Math.cos(t),this.sprite.body.acceleration.y=.5*this.MAX_SPEED*Math.sin(t)},i.prototype._awareWalk=function(){var t,i,e;return t=this.sprite.body.position.x-this.state.x,i=this.sprite.body.position.y-this.state.y,e=(t*t+i*i)/(this.MAX_SPEED*this.MAX_SPEED),this.sprite.body.velocity.x=t*e,this.sprite.body.velocity.y=i*e},i.prototype.destroy=function(){return this.sprite.destroy(),i.__super__.destroy.call(this)},i}(GameObject);var Player,__hasProp={}.hasOwnProperty,__extends=function(t,i){function e(){this.constructor=t}for(var s in i)__hasProp.call(i,s)&&(t[s]=i[s]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t};Player=function(t){function i(t,e){var s;i.__super__.constructor.call(this),s=game.input.keyboard.createCursorKeys(),this.controls={},this.controls.left=s.left,this.controls.down=s.down,this.controls.right=s.right,this.controls.up=s.up,this.controls.W=game.input.keyboard.addKey(Phaser.Keyboard.W),this.controls.A=game.input.keyboard.addKey(Phaser.Keyboard.A),this.controls.S=game.input.keyboard.addKey(Phaser.Keyboard.S),this.controls.D=game.input.keyboard.addKey(Phaser.Keyboard.D),this.sprite=game.add.sprite(t,e,"player"),game.physics.arcade.enable(this.sprite),this.sprite.anchor.x=.5,this.sprite.anchor.y=.75,this.i=0,this.footstepCountdown=3e3,this.gunCountdown=0,this.gun=game.add.audio("gunshot")}return __extends(i,t),i.prototype.update=function(){var t,i,e,s,r,o,a,n;for(s in GameObjects)if(o=GameObjects[s],o.isAlien)return game.physics.arcade.collide(this.sprite,o.sprite,this.destroy,null,this);return this.sprite.body.acceleration.x=0,this.sprite.body.acceleration.y=0,i=0,i=this.controls.left.isDown||this.controls.A.isDown?i-1:i,i=this.controls.right.isDown||this.controls.D.isDown?i+1:i,e=0,e=this.controls.down.isDown||this.controls.S.isDown?e+1:e,e=this.controls.up.isDown||this.controls.W.isDown?e-1:e,this.sprite.body.acceleration.x=this.sprite.body.velocity.x>0?600*i:300*i,this.sprite.body.acceleration.y=this.sprite.body.velocity.y>0?600*e:300*e,0===this.sprite.body.acceleration.x&&(this.sprite.body.acceleration.x=-5*this.sprite.body.velocity.x),0===this.sprite.body.acceleration.y&&(this.sprite.body.acceleration.y=-5*this.sprite.body.velocity.y),this.i=this.i+1,i=this.sprite.body.x+this.sprite.body.width*this.sprite.anchor.x-game.input.mousePointer.x,e=this.sprite.body.y+this.sprite.body.height*this.sprite.anchor.y-game.input.mousePointer.y,this.sprite.angle=-100+180*Math.atan2(e,i)/Math.PI+15*Math.sin(this.i/100),this.footstepCountdown=this.footstepCountdown-Math.abs(this.sprite.body.velocity.x)-Math.abs(this.sprite.body.velocity.y),this.footstepCountdown<0&&(this.footstepCountdown=3e3,new Circle(this.sprite.body.x+this.sprite.body.width*this.sprite.anchor.x,this.sprite.body.y+this.sprite.body.height*this.sprite.anchor.y,2*Math.max(Math.abs(this.sprite.body.velocity.x),Math.abs(this.sprite.body.velocity.y)))),this.sprite.bringToTop(),this.gunCountdown>0&&(this.gunCountdown=this.gunCountdown-1),0===this.gunCountdown&&game.input.activePointer.isDown&&(this.gunCountdown=250,this.gun.play(),t=this.sprite.angle+Math.atan(.5*this.sprite.body.width/(.75*this.sprite.body.height)),t=t*Math.PI/180,r=Math.sqrt(Math.pow(.5*this.sprite.body.width,2)+Math.pow(.75*this.sprite.body.height,2)),new Circle(this.sprite.body.x+this.sprite.body.width*this.sprite.anchor.x+r*Math.sin(t),this.sprite.body.y+this.sprite.body.height*this.sprite.anchor.y-r*Math.cos(t),2e3)),this.sprite.angle=this.sprite.angle+Math.max(this.gunCountdown,220)/2-110,a=this.sprite.body.x+this.sprite.body.width*this.sprite.anchor.x,n=this.sprite.body.y+this.sprite.body.height*this.sprite.anchor.y,20>a&&(this.sprite.body.x=this.sprite.body.x+20-a,this.sprite.body.velocity.x=0,this.sprite.body.acceleration.x=0),a>game.width-20&&(this.sprite.body.x=this.sprite.body.x-a+game.width-20,this.sprite.body.velocity.x=0,this.sprite.body.acceleration.x=0),20>n&&(this.sprite.body.y=this.sprite.body.y+20-n,this.sprite.body.velocity.y=0,this.sprite.body.acceleration.y=0),n>game.height-20?(this.sprite.body.y=this.sprite.body.y-n+game.height-20,this.sprite.body.velocity.y=0,this.sprite.body.acceleration.y=0):void 0},i.prototype.destroy=function(){var t;return i.__super__.destroy.call(this),game.stage.backgroundColor="#992d2d",t=this,window.setTimeout(function(){return t.sprite.destroy(),game.state.start("menu")})},i}(GameObject);var Graph;Graph=function(){function t(t){this.nodes=t}return t}();var game;game=new Phaser.Game(800,600,Phaser.AUTO,"phaser-stage"),game.state.add("menu",Menu),game.state.add("play",Play),game.state.start("menu");